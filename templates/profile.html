{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Profile - {{user_profile.user.username}}</title>
  <link href="{% static 'favicon.png' %}" rel="icon" type="image/png">
  <link rel="stylesheet" href="{% static 'css/main.min.css' %}">
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  <link rel="stylesheet" href="{% static 'css/responsive.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/tailwind.css' %}">
  <style>
    .cover { background-size:cover; background-position:center; min-height:220px; border-bottom-left-radius: .5rem; border-bottom-right-radius: .5rem; }
    .avatar-lg { width:150px; height:150px; border-radius:9999px; object-fit:cover; border:4px solid white; }
    .photo-thumb { width:100%; height:200px; object-fit:cover; border-radius: .5rem; }
  </style>
</head>
<body class="bg-gray-50 text-gray-800">

  <!-- Top cover -->
  <header class="bg-white shadow-sm">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <a href="/" class="text-xl font-bold text-pink-500">Dosto</a>
        <div class="flex items-center space-x-3">
          <a href="/settings" class="hidden sm:inline-block px-3 py-2 rounded bg-gray-100">Account Settings</a>
          <a href="/logout" class="px-3 py-2 rounded hover:bg-gray-100">Logout</a>
        </div>
      </div>
    </div>
  </header>

  <section class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 mt-6">
    <div class="bg-gradient-to-r from-pink-400 to-pink-300 cover rounded-lg overflow-hidden" style="background-image: url('{% static 'images/resources/timeline-1.jpg' %}')">
      <div class="max-w-6xl mx-auto px-4 py-6 flex items-end">
        <div class="flex items-end space-x-6">
          <img src="{{user_profile.profileimg.url}}" alt="avatar" class="avatar-lg shadow-lg">
          <div class="text-white">
            <h2 class="text-2xl font-bold">@{{user_profile.user.username}}</h2>
            <p class="text-sm opacity-90 mt-1">{{user_profile.bio}}</p>
            <div class="mt-3 grid grid-cols-3 gap-4 text-sm">
              <div class="text-center">
                <div class="font-bold text-lg">{{user_post_length}}</div>
                <div class="opacity-90">Posts</div>
              </div>
              <div class="text-center">
                <div class="font-bold text-lg">{{user_followers}}</div>
                <div class="opacity-90">Followers</div>
              </div>
              <div class="text-center">
                <div class="font-bold text-lg">{{user_following}}</div>
                <div class="opacity-90">Following</div>
              </div>
            </div>
          </div>
        </div>

        <div class="ml-auto">
          <form action="/follow" method="POST">
            {% csrf_token %}
            <input type="hidden" value="{{user.username}}" name="follower" />
            <input type="hidden" value="{{user_object.username}}" name="user" />
            {% if user_object.username == user.username %}
              <a href="/settings" class="bg-white text-pink-500 px-4 py-2 rounded-full font-semibold">Edit Profile</a>
            {% else %}
              <button type="submit" class="bg-white text-pink-500 px-4 py-2 rounded-full font-semibold">{{button_text}}</button>
            {% endif %}
          </form>
        </div>
      </div>
    </div>

    <!-- Gallery -->
    <section class="mt-6">
      <div class="bg-white rounded-lg shadow p-4">
        <h3 class="font-semibold">Photos</h3>
        <div class="mt-4 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 gap-4">
          {% for post in user_posts %}
            <a href="{{post.image.url}}" uk-lightbox class="block">
              <img src="{{post.image.url}}" alt="photo" class="photo-thumb">
            </a>
          {% endfor %}
        </div>
      </div>
    </section>
  </section>

  <script src="{% static 'js/main.min.js' %}"></script>
  <script src="{% static 'js/script.js' %}"></script>
</body>
</html>
